# 03
# This migration links the newly created media entities with entity reference field on the target bundle.

id: article_media
label: Article Media Mapping Migration
migration_group: media
source:
  plugin: content_entity:node
  bundle: article
  include_translations: false

destination:
  plugin: entity:node

process:
  nid: nid

  type:
    plugin: default_value
    default_value: article

  field_image_media:
  - plugin: file_id_lookup
    source: field_image
  - plugin: migration_lookup
    migration: article_images
    no_stub: true

  field_image2_media:
  - plugin: file_id_lookup
    source: field_image2
  - plugin: migration_lookup
    migration: article_images
    no_stub: true

migration_dependencies:
  required:
  - article_images
